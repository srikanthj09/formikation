formikation={dat:{els:null},defaults:{mapClass:!0,mapStyle:!0},init:function(a){return"undefined"==typeof document.body.style.maxHeight?this:(this.defaults=$.extend(this.defaults,a),void this.dat.els.each(function(){$(this).is(":checkbox, :radio")?formikation.processRadioCheck(this):$(this).is("select")?formikation.processSelects(this):$(this).is("input:file")&&formikation.processInputFile(this)}))},processRadioCheck:function(a){var b=$(a),c=b.closest("label");c.addClass(b.is(":checkbox")?"fk-check":"fk-radio"),b.on("fk_update",function(){b.prop("checked")?(b.closest("form").find(':radio[name="'+b.attr("name")+'"]').closest("label").removeClass("checked"),c.addClass("checked")):c.removeClass("checked")}),b.on("click",function(){b.trigger("fk_update")}),b.trigger("fk_update")},processSelects:function(a){var b=$(a),c=$("<span />").addClass("fk-select-label"),d=$("<span />"),e="fk-select";b.after(d.append(c)),d.addClass(e),this.defaults.mapClass&&d.addClass(b.attr("class")),this.defaults.mapStyle&&d.attr("style",b.attr("style")),b.addClass("has-fk-select").on("update",function(){formikation.changed(b,d),formikation.updateSelectWH(b)}).on("change",function(){d.addClass(formikation.getClass(b,"Changed")),formikation.changed(b,d),formikation.updateSelectWH(b)}).on("keyup",function(a){d.hasClass(formikation.getClass(b,"Open"))?(13==a.which||27==a.which)&&formikation.changed(b,d):(b.blur(),b.focus())}).on("mousedown",function(){d.removeClass(formikation.getClass(b,"Changed"))}).on("mouseup",function(a){d.hasClass(formikation.getClass(b,"Open"))||($("."+formikation.getClass(b,"Open")).not(d).length>0&&"undefined"!=typeof InstallTrigger?b.focus():(d.addClass(formikation.getClass(b,"Open")),a.stopPropagation(),$(document).one("mouseup."+formikation.getClass(b,"Open"),function(a){a.target!=b.get(0)&&$.inArray(a.target,b.find("*").get())<0?b.blur():formikation.changed(b,d)})))}).focus(function(){d.removeClass(formikation.getClass(b,"-changed")).addClass(formikation.getClass(b,"-focus"))}).blur(function(){d.removeClass(formikation.getClass(b,"-focus")+" "+formikation.getClass(b,"-open"))}).hover(function(){d.addClass(formikation.getClass(b,"-hover"))},function(){d.removeClass(formikation.getClass(b,"-hover"))}).trigger("update")},processInputFile:function(a){var b=$('<div class="fk-file-input">');$(a).on("change",function(){var a=$(this).val().replace(/C:\\fakepath\\/i,"");a||(a="Select file..."),$(this).prev("p").html(a)}),$(a).wrap(b).parent().prepend("<p>Select file...</p>")},updateSelectWH:function(a){var b=$(a),c=b.next("span");c.css({display:"inline-block"});var d=parseInt(c.outerWidth(),10),e=parseInt(c.outerHeight(),10);b.attr("disabled")?c.addClass(formikation.getClass(b,"Disabled")):c.removeClass(formikation.getClass(b,"Disabled")),b.css({"-webkit-appearance":"menulist-button",width:d,height:e,position:"absolute",opacity:0,fontSize:c.css("font-size")})},getClass:function(a,b){var c=a.is("input:file")?"fk-file":"fk-select";return c+b},changed:function(a,b){var c=a.find(":selected"),d=b.children(":first"),e=c.html()||a.val();d.html(e),c.attr("disabled")?b.addClass(getClass(a,"fk-disable-option")):b.removeClass(formikation.getClass(a,"fk-disable-option")),setTimeout(function(){b.removeClass(formikation.getClass(a,"Open")),$(document).off("mouseup."+formikation.getClass(a,"Open"))},60)}},function(a){a.fn.formikation=function(a){formikation.dat.els=this,formikation.init(a)}}(jQuery);